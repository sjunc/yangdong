<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ì–‘ë™ì´ ì±—ë´‡ ë©”ì¸ í˜ì´ì§€</title>
<style>
  :root{
    --brand:#1565d8; --brand-dark:#0f4aa4;
    --bg:#f3f6fb; --card:#ffffff;
    --text:#1f2a37; --muted:#6b7280;
    --shadow:0 8px 24px rgba(0,0,0,.06);
    --sbw:260px;
    --assist-shift: 120px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family:"Pretendard","Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,"Malgun Gothic",sans-serif;
  }

  /* ===== Sidebar ===== */
  .sidebar{
    position:fixed; inset:0 auto 0 0; width:var(--sbw); height:100vh;
    background:linear-gradient(180deg,var(--brand),var(--brand-dark));

    color:#fff; display:flex; flex-direction:column; padding:18px 14px;
    transition:transform .25s ease; z-index:50;
  }
  body.sidebar-closed .sidebar{ transform:translateX(-100%); }

  .sb-top{display:flex; align-items:center; gap:10px; padding:8px 10px 14px 8px; border-bottom:1px solid rgba(255,255,255,.18); margin-bottom:12px;}
  .logo{display:flex; align-items:center; gap:10px; font-weight:700; font-size:18px;}
  .logo img{width:28px; height:28px; border-radius:50%; background:#fff}
  .sb-links{display:flex; flex-direction:column; gap:6px; padding:10px 0}
  .sb-item{
    display:flex; align-items:center; gap:10px; padding:12px; border-radius:10px;
    color:#eaf2ff; text-decoration:none; cursor:pointer; transition:background .18s ease;
  }
  .sb-item .icon{width:22px; height:22px; display:grid; place-items:center; background:rgba(255,255,255,.18); border-radius:8px; font-size:13px}
  .sb-item:hover{background:rgba(255,255,255,.14)}
  .sb-item.active{background:#fff; color:var(--brand)}
  .sb-bottom{margin-top:auto; display:flex; align-items:center; gap:10px; padding:10px 12px; opacity:.9}
  .sb-bottom img{width:44px; height:44px; border-radius:50%; background:#fff}
  .sb-bottom .role{font-size:12px; opacity:.9}

  /* ===== Main ===== */
  .main{ min-height:100vh; display:flex; flex-direction:column; margin-left:var(--sbw); transition:margin-left .25s ease; }
  body.sidebar-closed .main{ margin-left:0; }

  .topbar{
    height:64px; background:#fff; box-shadow:var(--shadow);
    padding:0 16px; display:flex; align-items:center; gap:8px; justify-content:space-between;
    position: sticky; top:0; z-index:60;
  }
  .auth-btn{ padding:6px 12px; border:none; border-radius:8px; cursor:pointer; background:#1565d8; color:#fff; font-weight:600; transition:background .2s ease;}
  .auth-btn:hover{ background:#0f4aa4; }
  .left-group{display:flex; align-items:center; gap:8px;}
  .sb-toggle{
    border:none; background:transparent; width:40px; height:40px; border-radius:10px;
    font-size:18px; cursor:pointer; display:grid; place-items:center; color:#1f2a37;
  }
  .sb-toggle:hover{background:#eef3ff}
  .topbar .title{font-weight:700; font-size:18px}
  .right{display:flex; align-items:center; gap:12px; color:var(--muted)}

  .content{flex:1; padding:50px; position:relative;}
  
  .board{height:100%; display:grid; place-items:center;}
  .panel{
    width:min(1200px, 92%); margin:40px auto 200px;
    background:#f7faff; border-radius:24px;
    box-shadow:inset 0 10px 18px rgba(0,0,0,.03), 0 18px 40px rgba(23,57,132,.08);
    padding:38px 36px;
  }
/* âœ¨ ì¹´ë“œ ì•ˆë‚´íŒ íš¨ê³¼ */
/* âœ¨ ì¹´ë“œ ì „ì²´ë¥¼ ë®ëŠ” íŒì—…í˜• ìŠ¤íƒ€ì¼ */
/* íŒ¨ë„ì„ ì˜¤ë²„ë ˆì´ ê¸°ì¤€ì ìœ¼ë¡œ */
/* íŒ¨ë„/ì˜¤ë²„ë ˆì´ ì•ˆì˜ íŠ¸ìœ„ëª¨ì§€ IMGëŠ” í•­ìƒ ì‘ê²Œ ê³ ì • */
.panel img.emoji,
.tile-overlay img.emoji,
.overlay-inner img.emoji {
  width: 24px !important;
  height: 24px !important;
  display: inline-block !important;
  vertical-align: -0.2em;
}

.tiles{display:grid; grid-template-columns:repeat(3,1fr); gap:18px;}

/* ê¸°ë³¸ ì¹´ë“œ */
.tile{
    background:#f9fbff; border-radius:18px; padding:50px; box-shadow:0 3px 0 #e3ecff inset, var(--shadow);
    display:flex; gap:14px; align-items:center; cursor:pointer; transition:transform .12s ease, box-shadow .12s ease;
    text-decoration:none; color:inherit;
  }

/* âœ… ì•„ì´ì½˜ ê¸°ë³¸ ì„¤ì • (í¬ê¸° ê³ ì • + ê²¹ì¹¨ ë°©ì§€) */
.tile .ic{width:56px; height:56px; border-radius:14px; display:grid; place-items:center; background:#e9f1ff; font-size:22px;}
.tile:hover{transform:translateY(-2px); box-shadow:0 10px 28px rgba(0,0,0,.08)}
.tile .txt .k{font-weight:750}
.tile .txt .s{font-size:13px; color:var(--muted); margin-top:2px}

.tile .ic img,
.tile .ic svg,
.tile .ic span,
.tile .ic::before {
  width: 48px !important;
  height: 48px !important;
  object-fit: contain;
  flex-shrink: 0;
}

/* âœ… ì˜¤ë²„ë ˆì´ (ì²˜ìŒì—” ìˆ¨ê¹€) */
.tile-overlay {
  position: absolute;
  inset: 0;
  background: #fff;
  border-radius: 24px;
  opacity: 0;
  transform: scale(0.97);
  transition: all 0.4s ease;
  pointer-events: none;
}

/* ë‚´ë¶€ í…ìŠ¤íŠ¸ */
.overlay-inner {
  padding: 40px;
}

.overlay-inner h3 {
  font-size: 22px;
  margin-bottom: 20px;
}

.overlay-inner ul {
  font-size: 16px;
  line-height: 1.7;
  margin-bottom: 25px;
}

.open-btn {
  background: var(--brand, #1565d8);
  color: #fff;
  border: none;
  padding: 10px 18px;
  border-radius: 10px;
  cursor: pointer;
}
.tile .ic img,
.tile .ic svg,
.tile .ic span,
.tile .ic twemoji,
.tile .ic * {
  max-width: 48px !important;
  max-height: 48px !important;
  width: 48px !important;
  height: 48px !important;
  flex-shrink: 0 !important;
  object-fit: contain !important;
  transform: none !important; /* ë¶€ëª¨ transform ë¬´ì‹œ */
  position: relative !important;
  z-index: 2 !important;
}

/* í´ë¦­ ì‹œ content ì¤‘ì•™ì— ë§ì¶° í™•ëŒ€ */
.tile.active {
  position: absolute;
  top: 80px;
  left: 50%;
  transform: translateX(-50%) scale(1);
  width: min(1100px, 90%);
  height: 600px;
  background: #ffffff;
  border-radius: 24px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.18);
  z-index: 200;
  transition: all 0.4s ease;
  overflow: hidden;
}

/* ì•„ì´ì½˜ / í…ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸° */
.tile.active .txt,
.tile.active .ic {
  opacity: 0;
  visibility: hidden;
  transform: scale(0.9);
  transition: all 0.2s ease;
}

/* ë‚´ë¶€ í°ìƒ‰ íŒ¨ë„ */
.tile.active .tile-overlay {
  opacity: 1;
  pointer-events: auto;
  position: absolute;
  inset: 0;
  background: #fff;
  border-radius: 24px;
  transition: all 0.4s ease;
  box-shadow: none;
}

/* ë‚´ìš© ìì—°ìŠ¤ëŸ½ê²Œ ë“±ì¥ */
.tile.active .overlay-inner {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 0.4s ease 0.1s, transform 0.4s ease 0.1s;
}

.tile .overlay-inner {
  opacity: 0;
  transform: translateY(10px);
  transition: opacity 0.2s ease, transform 0.2s ease;
}

  /* ===== Assistant ===== */
  .assistant-wrap{
    position: fixed; bottom: 100px;
    left: calc(var(--sbw) + (100vw - var(--sbw)) / 2 - var(--assist-shift));
    transform: translateX(-50%); display:flex; align-items:flex-end; gap:0; z-index:40;
    pointer-events:auto;
  }
  body.sidebar-closed .assistant-wrap{ left: calc(50% - var(--assist-shift)); transform: translateX(-50%); }
  .yang-stand{ width:400px; height:400px; object-fit:contain; filter:drop-shadow(0 12px 18px rgba(0,0,0,.22)); pointer-events:none; position:relative; top:100px; }
  .assistant-bar{ position:relative; height:64px; display:grid; grid-template-columns:120px 1fr 100px; align-items:center; gap:12px; background:#3c4250; color:#fff; border-radius:28px; padding:10px 12px; box-shadow:0 14px 30px rgba(0,0,0,.24); margin-left:-100px; width:min(860px, calc((100vw - var(--sbw)) - 300px - 70px)); transition:width .25s ease, margin-left .2s ease; pointer-events:auto; }
  .assistant-bar::after{ content:""; position:absolute; left:-10px; bottom:30px; width:18px; height:18px; background:#3c4250; transform:rotate(45deg); border-radius:3px; box-shadow:0 6px 12px rgba(0,0,0,.18); }
  body.sidebar-closed .assistant-bar{ width:min(960px, calc(100vw - 300px - 70px)); }
  .chip-icon{ width:40px; height:40px; border:none; border-radius:10px; background:rgba(255,255,255,.12); color:#fff; cursor:pointer; margin-right:6px; }
  .bar-left{display:flex; align-items:center}
  .bar-center input{ width:100%; height:44px; border:none; outline:none; background:rgba(255,255,255,.12); color:#fff; border-radius:12px; padding:0 12px; font-size:14px; }
  .mic, .send{ width:44px; height:44px; border:none; border-radius:12px; cursor:pointer; }
  .mic{ background:rgba(255,255,255,.12); color:#fff; margin-right:6px; }
  .send{ background:#00a2ff; color:#fff; font-weight:800; }

  /* === ğŸ’¬ ì±„íŒ… ë§í’ì„  UI === */
/* ğŸ’¬ ì±„íŒ… ë°•ìŠ¤ - ì‚¬ì´ë“œë°” êµ¬ì¡° ê¸°ì¤€ ì™„ë²½ ì •ë ¬ */
.chat-box {
  position: fixed;
  bottom: 155px; /* ğŸ”¥ ì…ë ¥ì°½ ìœ„ë¡œ ì •í™•íˆ ë„ìš°ê¸° */
  
  /* ì‚¬ì´ë“œë°” ìˆì„ ë•Œ */
  left: calc(var(--sbw) + (100vw - var(--sbw)) / 2 - var(--assist-shift));
  transform: translateX(-32%);
  
  width: min(840px, calc(100vw - var(--sbw) - 300px));
  max-height: 650px;
  overflow-y: auto; 
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0);
  z-index: 40; /* âœ… assistant-barë³´ë‹¤ ìœ„ */
  
  display: flex;  
  flex-direction: column;
  gap: 10px;
  padding: 20px;
  transition: all 0.3s ease;
}

/* ì‚¬ì´ë“œë°” ë‹«í˜ ì‹œ ì¤‘ì•™ì •ë ¬ ìœ ì§€ */
body.sidebar-closed .chat-box {
  left: 52%;
  transform: translateX(-50%);
  width: min(900px, calc(100vw - 300px));
}
.msg.user {
  background: #1565d8;
  color: #fff;
  border-radius: 18px 18px 2px 18px;
  padding: 10px 16px;
  margin: 8px 0 8px auto;
  width: fit-content;
  max-width: 75%;
}
.msg.bot {
  background: #f1f5ff;
  color: #1f2a37;
  border-radius: 18px 18px 18px 2px;
  padding: 10px 16px;
  margin: 8px auto 8px 0;
  width: fit-content;
  max-width: 75%;
}


  /* ====== íƒœë¸”ë¦¿ ê·œì¹™ ====== */
  @media (max-width:1100px){
    .tiles{grid-template-columns:repeat(2,1fr)}
    .assistant-wrap{ bottom:110px; }
    .assistant-bar{ grid-template-columns:100px 1fr 88px; }
  }

  /* ====== ëª¨ë°”ì¼ ê·œì¹™(í•µì‹¬) ====== */
  @media (max-width:768px){
    :root{ --sbw: 78vw; --assist-shift:0px; }

    /* ì‚¬ì´ë“œë°”: ê¸°ë³¸ ì ‘í˜(ì˜¤ë²„ë ˆì´ ëª¨ë“œ) */
    .sidebar{
      transform: translateX(-100%);
      z-index:100;
    }
    body.sb-open .sidebar{ transform: translateX(0); }
    /* ë°°ê²½ ë”¤ */
    .sb-dim{
      position: fixed; inset:0; background:rgba(0,0,0,.35);
      z-index:90; display:none;
    }
    body.sb-open .sb-dim{ display:block; }

    /* ë©”ì¸ ì¢Œì—¬ë°± ì œê±° */
    .main{ margin-left:0 !important; }
    .content{ padding:16px !important; }

    /* íŒ¨ë„/íƒ€ì¼ ì¶•ì†Œ + 1ì—´ */
    .panel{
      width:100% !important; margin:12px auto 120px !important;
      padding:16px !important; border-radius:14px !important;
      box-shadow:0 6px 16px rgba(0,0,0,.06) !important; background:#fff !important;
    }
    .tiles{ grid-template-columns:1fr !important; gap:12px !important; }
    .tile{ padding:16px !important; border-radius:12px !important; }

    /* ìºë¦­í„° ìˆ¨ê¹€ + ì±„íŒ…ë°” ì¤‘ì•™ */
    .yang-stand{ display:none !important; }
    .assistant-wrap{
      left:50% !important; bottom:20px !important; transform:translateX(-50%) !important;
      z-index:40;
    }
    .assistant-bar{
      margin-left:0 !important;
      width:min(92vw, 680px) !important;
      grid-template-columns:90px 1fr 88px !important;
    }
    /* ì‚¬ì´ë“œë°” ì—´ë¦´ ë•Œ ì±„íŒ…ë°” ì•„ë˜ë¡œ */
    body.sb-open .assistant-wrap{ z-index:10; }
  }

  .sb-item .icon img.emoji{ width:16px; height:16px; display:block; }
  .tile .ic img.emoji{ width:28px; height:28px; display:block; }
  .chip-icon img.emoji, .mic img.emoji{ width:20px; height:20px; display:block; margin:0 auto; }
  
  /* === ì±„íŒ… ëª¨ë“œ ì „í™˜ === */
body.chatting .panel,
body.chatting .tiles {
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease;
}

</style>
</head>
<body class="sidebar-closed">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sb-top">
      <div class="logo"><img src="image/yangdongi.png" alt="ì–‘ë™ì´"><span>ì–‘ë™ì´</span></div>
    </div>
    <nav class="sb-links">
    <!-- 1ï¸âƒ£ ìƒˆ ì±„íŒ… ë²„íŠ¼ -->
    <a class="sb-item active" id="newChatBtn" href="#">
      <span class="icon">ğŸ’¬</span>
      <span>ìƒˆ ì±„íŒ…</span>
    </a>
      
      <a class="sb-item" href="#"><span class="icon">ğŸ </span><span>ì˜¤ëŠ˜</span></a>
      <a class="sb-item" href="#"><span class="icon">ğŸ“…</span><span>ì§€ë‚œ 7ì¼</span></a>
      <a class="sb-item" href="#"><span class="icon">ğŸ“š</span><span>í•™êµ í™ˆí˜ì´ì§€</span></a>
      <a class="sb-item" href="#"><span class="icon">ğŸ‘¤</span><span>ê°œì¸ ì •ë³´</span></a>
      <a class="sb-item" href="#"><span class="icon">ğŸ“</span><span>í•™ì‚¬ ì¼ì •</span></a>
      <a class="sb-item" href="#"><span class="icon">âš™ï¸</span><span>ì„¤ì •</span></a>
    </nav>

    <!-- #ï¸âƒ£ ì‚¬ìš©ì ì •ë³´ê°€ ì±„ì›Œì§ˆ ì˜ì—­ -->
    <div class="sb-bottom" id="userBox">
      <img src="image/user.png" alt="ì‚¬ìš©ì">
      <div class="info">
        <div><strong id="userName">ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</strong></div>
        <div class="role" id="userMeta">-</div>
      </div>
    </div>
  </aside>

  <!-- Main -->
  <main class="main">
    <header class="topbar">
      <div class="left-group">
        <button class="sb-toggle" id="toggleBtn">â˜°</button>
        <div class="title">ì–‘ë™ì´ ì±—ë´‡ 1.0 </div>
      </div>

      <!-- #ï¸âƒ£ ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ ìˆ¨ê¸¸ ë²„íŠ¼ -->
      <div class="right">
        <span class="muted" id="todayText"></span>
        <button id="authBtn" class="auth-btn"></button>
        <button id="logoutBtn" class="auth-btn" style="display:none">ë¡œê·¸ì•„ì›ƒ</button>
      </div>
    </header>

<section class="content">
  <div class="board">
    <div class="panel">
      <div class="tiles">

        <!-- âœ… ìˆ˜ì—… ì‹œê°„í‘œ -->
        <!-- ìˆ˜ì—… ì‹œê°„í‘œ -->
<!-- âœ… ìˆ˜ì—… ì‹œê°„í‘œ ì¹´ë“œ -->
<!-- âœ… ìˆ˜ì—… ì‹œê°„í‘œ -->
<div class="tile">
  <div class="ic">ğŸ—“ï¸</div>
  <div class="txt">
    <div class="k">ìˆ˜ì—… ì‹œê°„í‘œ</div>
    <div class="s">ì´ë²ˆ ì£¼ ìˆ˜ì—… ë° ê°•ì˜ì‹¤</div>
  </div>

  <div class="tile-overlay">
    <div class="overlay-inner">
      <h3>ğŸ“… ì´ë²ˆ ì£¼ ìˆ˜ì—… ì‹œê°„í‘œ</h3>
      <ul>
        <li>ì›”ìš”ì¼ - ì•Œê³ ë¦¬ì¦˜ - 09:00 ~ 10:30 (C201)</li>
        <li>í™”ìš”ì¼ - ë°ì´í„°ë² ì´ìŠ¤ - 11:00 ~ 12:30 (A304)</li>
        <li>ìˆ˜ìš”ì¼ - ì¸ê³µì§€ëŠ¥ ê¸°ì´ˆ - 13:00 ~ 14:30 (B105)</li>
        <li>ëª©ìš”ì¼ - ì›¹í”„ë¡œê·¸ë˜ë° - 15:00 ~ 16:30 (D202)</li>
        <li>ê¸ˆìš”ì¼ - í”„ë¡œì íŠ¸ ì‹¤ìŠµ - 10:00 ~ 12:00 (Lab 2)</li>
      </ul>
      <button class="open-btn" onclick="window.location.href='feature.html?feature=schedule'"> ìì„¸íˆ ë³´ê¸°</button>
    </div>
  </div>
</div>

<!-- âœ… ìê²©ì¦ ì•ˆë‚´ -->
<div class="tile">
  <div class="ic">ğŸ§¾</div>
  <div class="txt">
    <div class="k">ìê²©ì¦ ì•ˆë‚´</div>
    <div class="s">ì¶”ì²œ ìê²©ì¦ / ì‹œí—˜ì¼ì •</div>
  </div>

  <div class="tile-overlay">
    <div class="overlay-inner">
      <h3>ğŸ§¾ ì¶”ì²œ ìê²©ì¦ & ì‹œí—˜ ì¼ì •</h3>
      <ul>
        <li>ì •ë³´ì²˜ë¦¬ê¸°ì‚¬ - 2025.10.20 (ì ‘ìˆ˜ ë§ˆê°: 10.05)</li>
        <li>SQLD - 2025.11.12 (ì ‘ìˆ˜ ë§ˆê°: 10.30)</li>
        <li>ë¦¬ëˆ…ìŠ¤ë§ˆìŠ¤í„° 2ê¸‰ - 2025.12.03 (ì ‘ìˆ˜ ë§ˆê°: 11.20)</li>
      </ul>
      <button class="open-btn" onclick="window.location.href='feature.html?feature=license'"> ìì„¸íˆ ë³´ê¸°</button>
    </div>
  </div>
</div>

<!-- âœ… í•™ì  ì¡°íšŒ -->
<div class="tile">
  <div class="ic">ğŸ“Š</div>
  <div class="txt">
    <div class="k">í•™ì  ì¡°íšŒ</div>
    <div class="s">ëˆ„ì  / í•™ê¸°ë³„ ì„±ì </div>
  </div>

  <div class="tile-overlay">
    <div class="overlay-inner">
      <h3>ğŸ“Š í•™ì  ìš”ì•½</h3>
      <ul>
        <li>ëˆ„ì  í‰ê·  í•™ì : <strong>3.85 / 4.5</strong></li>
        <li>ì „ê³µ í‰ê·  í•™ì : 3.92</li>
        <li>êµì–‘ í‰ê·  í•™ì : 3.78</li>
      </ul>
      <button class="open-btn" onclick="window.location.href='feature.html?feature=grade'"> ìì„¸íˆ ë³´ê¸°</button>
    </div>
  </div>
</div>

<!-- âœ… eClass -->
<div class="tile">
  <div class="ic">ğŸ–¥ï¸</div>
  <div class="txt">
    <div class="k">eClass</div>
    <div class="s">ê³¼ì œ</div>
  </div>

  <div class="tile-overlay">
    <div class="overlay-inner">
      <h3>ğŸ–¥ï¸ ê³¼ì œ </h3>
      <ul>
        <li>[ê³¼ì œ] AI í”„ë¡œì íŠ¸ ë³´ê³ ì„œ â€“ ë§ˆê°: 2025.10.07</li>
        <li>[ê³¼ì œ] ë°ì´í„° ë¶„ì„ ì¤‘ê°„ ë³´ê³ ì„œ â€“ ë§ˆê°: 2025.10.10</li>
        <li>[ê³µì§€] ê¸°ë§ í”„ë¡œì íŠ¸ ë°œí‘œ â€“ 2025.12.01 ì˜ˆì •</li>
      </ul>
      <button class="open-btn" onclick="window.location.href='feature.html?feature=eclass'"> ìì„¸íˆ ë³´ê¸°</button>
    </div>
  </div>
</div>

<!-- âœ… ê³µì§€ì‚¬í•­ -->
<div class="tile">
  <div class="ic">ğŸ“¢</div>
  <div class="txt">
    <div class="k">ê³µì§€ì‚¬í•­</div>
    <div class="s">í•™êµ ê³µì§€ì‚¬í•­ / í•™ê³¼ ê³µì§€ì‚¬í•­</div>
  </div>

  <div class="tile-overlay">
    <div class="overlay-inner">
      <h3>ğŸ“¢ ê³µì§€ì‚¬í•­</h3>
      <ul>
        <li>í•™êµ ê³µì§€ì‚¬í•­</li>
        <li>í•™ê³¼ ê³µì§€ì‚¬í•­</li>
        <li>----------</li>
      </ul>
      <button class="open-btn" onclick="window.location.href='feature.html?feature=library'"> ìì„¸íˆ ë³´ê¸°</button>
    </div>
  </div>
</div>

<!-- âœ… ì¡¸ì—… í•™ì  ì´ìˆ˜ -->
<div class="tile">
  <div class="ic">ğŸ“</div>
  <div class="txt">
    <div class="k">ì¡¸ì—… í•™ì  ì´ìˆ˜</div>
    <div class="s">ì „ê³µ / êµì–‘ ì´ìˆ˜ì²´í¬</div>
  </div>

  <div class="tile-overlay">
    <div class="overlay-inner">
      <h3>ğŸ“ ì¡¸ì—… ìš”ê±´ ì§„í–‰ ìƒí™©</h3>
      <ul>
        <li>ì „ê³µ ì´ìˆ˜: 78 / 80 í•™ì </li>
        <li>êµì–‘ ì´ìˆ˜: 28 / 30 í•™ì </li>
        <li>ì´ ì´ìˆ˜: 125 / 130 í•™ì </li>
      </ul>
      <button class="open-btn" onclick="window.location.href='feature.html?feature=graduate'"> ìì„¸íˆ ë³´ê¸°</button>
    </div>
  </div>
</div>

</section>
<!-- ğŸ’¬ ì±„íŒ… ë§í’ì„  ë°•ìŠ¤ -->
<div class="chat-box" id="chatBox"></div>

      <!-- Assistant -->
      <div class="assistant-wrap">
        <img class="yang-stand" src="image/yangdongi.png" alt="ì–‘ë™ì´">
        <div class="assistant-bar">
          <div class="bar-left">
            <button class="chip-icon">ğŸŒ</button>
            <button class="chip-icon">ğŸ“˜</button>
            <button class="chip-icon">âš™ï¸</button>
          </div>
          <div class="bar-center"><input id="ask" type="text" placeholder="ì•ˆë…•! ë‚œ ì–‘ë™ì´ì•¼. ì–´ë–¤ ì ì´ ê¶ê¸ˆí•´?" /></div>
          <div class="bar-right" style="display:flex;align-items:center;gap:6px;">
            <button class="mic">ğŸ™</button>
            <button class="send" onclick="send()">âœ</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ ë”¤ -->
  <div class="sb-dim"></div>

  <!-- Twemoji -->
  <!-- âœ… TwemojiëŠ” ì´ í•œ ë²ˆë§Œ ì¡´ì¬í•´ì•¼ í•¨ -->
<!-- twemoji ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ (í•œ ë²ˆë§Œ) -->
<script src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js" crossorigin="anonymous"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
  // âœ… ì¹´ë“œ ì•„ì´ì½˜ê³¼ íŒ¨ë„ ë‚´ë¶€ ì•„ì´ì½˜(ì œëª© í¬í•¨) ëª¨ë‘ Twemoji ì ìš©
  twemoji.parse(document.body, { folder: 'svg', ext: '.svg' });
});

  // ì˜¤ëŠ˜ ë‚ ì§œ
  (function(){
    const el=document.getElementById('todayText');
    const d=new Date(); const w=['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][d.getDay()];
    el.textContent=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ${w}`;
  })();

  // Sidebar toggle (ë°ìŠ¤í¬í†±: ì ‘ê¸°/í¼ì¹˜ê¸°, ëª¨ë°”ì¼: ì˜¤ë²„ë ˆì´ ì—´ê¸°/ë‹«ê¸°)
  const toggleBtn = document.getElementById('toggleBtn');
  const dim = document.querySelector('.sb-dim');
  function isMobile(){ return window.innerWidth <= 768; }
  function closeAllSidebars(){ document.body.classList.remove('sb-open'); // ëª¨ë°”ì¼ ì˜¤ë²„ë ˆì´ ë‹«ê¸°
    // ë°ìŠ¤í¬í†±ì—ì„  ê¸°ë³¸ í¼ì¹¨ ìƒíƒœ ìœ ì§€(ì›í•˜ë©´ ì•„ë˜ ì¤„ì„ ì£¼ì„ í•´ì œ)
    // document.body.classList.add('sidebar-closed');
  }

  toggleBtn.addEventListener('click', ()=>{
    if (isMobile()){
      document.body.classList.toggle('sb-open');
    } else {
      document.body.classList.toggle('sidebar-closed');
    }
  });

  // ë”¤ í´ë¦­ ì‹œ ë‹«ê¸°
  dim.addEventListener('click', closeAllSidebars);
  // í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ ëª¨ë“œ ì •ë¦¬
  window.addEventListener('resize', ()=>{
    if (isMobile()){
      // ëª¨ë°”ì¼ì—ì„œëŠ” ë©”ì¸ì€ í•­ìƒ ì¢Œì—¬ë°± ì—†ìŒ, ì‚¬ì´ë“œë°”ëŠ” ê¸°ë³¸ ë‹«í˜
      document.body.classList.add('sidebar-closed');
    } else {
      // ë°ìŠ¤í¬í†±ì—ì„œëŠ” ì˜¤ë²„ë ˆì´ ëª¨ë“œ í•´ì œ
      document.body.classList.remove('sb-open');
    }
  });

  function send(){
    const v=document.getElementById('ask').value.trim();
    if(!v) return;
    console.log('[ASK]',v);
    document.getElementById('ask').value='';
  }

  // âœ… ë¡œê·¸ì•„ì›ƒ
  async function logout(){
    try {
      await fetch("/api/logout", { method:"POST", credentials:"include" }).catch(()=>{});
    } catch(_) {}
    localStorage.removeItem("isLoggedIn");
    localStorage.removeItem("isGuest");
    sessionStorage.clear();
    location.href = "login.html";
  }

  // #ï¸âƒ£ ì„¸ì…˜ ì •ë³´ â†’ ì¢Œì¸¡ í•˜ë‹¨ ë°•ìŠ¤ & ë²„íŠ¼ ìƒíƒœ
  async function hydrateUserUI() {
    try {
      const res = await fetch("/api/me", { credentials: "include" });
      const data = await res.json().catch(()=> ({}));

      const btn = document.getElementById("authBtn");
      const logoutBtn = document.getElementById("logoutBtn");
      const nameEl = document.getElementById("userName");
      const metaEl = document.getElementById("userMeta");

      if (res.ok && data.ok && data.user) {
        const u = data.user;
        nameEl.textContent = u.name || "ì´ë¦„ ì—†ìŒ";
        metaEl.innerHTML = `${u.uid || "-"}<br>${u.department || "-"}`;

        if (btn) btn.style.display = "none";
        if (logoutBtn) {
          logoutBtn.style.display = "inline-flex";
          logoutBtn.onclick = logout;
        }
      } else {
        if (btn) {
          btn.textContent = "ë¡œê·¸ì¸";
          btn.onclick = ()=> location.href="login.html";
          btn.style.display = "inline-flex";
        }
        if (logoutBtn) logoutBtn.style.display = "none";
      }
    } catch (e) {
      console.warn("ì„¸ì…˜ ì¡°íšŒ ì‹¤íŒ¨", e);
    }
  }
  hydrateUserUI();
document.addEventListener('DOMContentLoaded', function(){
  const tiles = document.querySelectorAll('.tile');
  let activeTile = null;

  tiles.forEach(tile => {
    tile.addEventListener('click', (e) => {
      e.stopPropagation();

      // ì´ë¯¸ ì—´ë ¤ ìˆëŠ” ì¹´ë“œ ë‹¤ì‹œ í´ë¦­ â†’ ë‹«ê¸°
      if (tile.classList.contains('active')) {
        tile.classList.remove('active');
        activeTile = null;
        return;
      }

      // ë‹¤ë¥¸ ì¹´ë“œ ë‹«ê¸°
      if (activeTile) activeTile.classList.remove('active');

      // ìƒˆ ì¹´ë“œ ì—´ê¸°
      tile.classList.add('active');
      activeTile = tile;
    });
  });

  // ë°”ê¹¥ í´ë¦­ ì‹œ ë‹«ê¸°
  document.addEventListener('click', (e) => {
    if (activeTile && !activeTile.contains(e.target)) {
      activeTile.classList.remove('active');
      activeTile = null;
    }
  });
});

// âœ… FastAPI ì„œë²„ ì£¼ì†Œ (AI ë°±ì—”ë“œ)
const API_BASE = "http://127.0.0.1:9000";  // â† app.py ì‹¤í–‰ ì¤‘ì¸ ì£¼ì†Œë¡œ ë§ì¶°ì•¼ í•¨

// âœ… 1ï¸âƒ£ í…ìŠ¤íŠ¸ ì…ë ¥ â†’ FastAPI RAG ëŒ€í™” ì—°ê²°
async function send() {
  const input = document.getElementById("ask");
  const text = input.value.trim();
  if (!text) return;

  const box = document.getElementById("chatBox");
  input.value = "";

  // ì‚¬ìš©ì ë§í’ì„  í‘œì‹œ
  box.innerHTML += `<div class="msg user">ğŸ§‘â€ğŸ’» ${text}</div>`;
  box.scrollTop = box.scrollHeight;

  try {
    // --- (1) GPT ëŒ€í™” ìš”ì²­ ---
    const chatRes = await fetch(`${API_BASE}/rag/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ query: text })  // ğŸ‘ˆ FastAPIì— query ì „ë‹¬
    });
    const data = await chatRes.json();

    // --- (2) ë´‡ ì‘ë‹µ í‘œì‹œ ---
    box.innerHTML += `<div class="msg bot">ğŸ¤– ${data.answer}</div>`;
    box.scrollTop = box.scrollHeight;

    // --- (3) TTS ìŒì„± ë³€í™˜ ìš”ì²­ ---
    const ttsRes = await fetch(`${API_BASE}/tts`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text: data.answer })
    });
    if (ttsRes.ok) {
      const tts = await ttsRes.json();
      new Audio(`data:audio/mpeg;base64,${tts.audio_b64}`).play(); // ğŸ‘ˆ ë°”ë¡œ ì¬ìƒ
    }

  } catch (e) {
    box.innerHTML += `<div class="msg bot">âš ï¸ ì„œë²„ ì—°ê²° ì‹¤íŒ¨: ${e.message}</div>`;
  }
}

// âœ… 2ï¸âƒ£ ìŒì„± ì…ë ¥ â†’ FastAPI ìŒì„±(STT) ëŒ€í™” ì—°ê²°
let mediaRecorder, audioChunks = [];
document.querySelector(".mic").addEventListener("click", async () => {

  // ë‹¤ì‹œ í´ë¦­í•˜ë©´ ë…¹ìŒ ì¢…ë£Œ
  if (mediaRecorder && mediaRecorder.state === "recording") {
    mediaRecorder.stop();
    return;
  }

  try {
    // --- ë§ˆì´í¬ ë…¹ìŒ ì‹œì‘ ---
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    mediaRecorder = new MediaRecorder(stream);
    audioChunks = [];

    mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
    mediaRecorder.onstop = async () => {
      const blob = new Blob(audioChunks, { type: "audio/webm" });
      const fd = new FormData();
      fd.append("file", blob, "voice.webm");

      // --- (4) FastAPIë¡œ ì „ì†¡ ---
      const res = await fetch(`${API_BASE}/voice-chat`, {
        method: "POST",
        body: fd
      });
      const d = await res.json();

      // --- (5) ì‘ë‹µ í‘œì‹œ ---
      const box = document.getElementById("chatBox");
      box.innerHTML += `<div class="msg user">ğŸ™ï¸ ${d.user_text}</div>`;
      box.innerHTML += `<div class="msg bot">ğŸ¤– ${d.assistant_text}</div>`;
      box.scrollTop = box.scrollHeight;

      // --- (6) ë´‡ ìŒì„± ì¬ìƒ ---
      new Audio(`data:audio/mpeg;base64,${d.audio_b64}`).play();
    };

    mediaRecorder.start();
    alert("ğŸ™ï¸ ë…¹ìŒ ì‹œì‘! ë‹¤ì‹œ ëˆ„ë¥´ë©´ ì¢…ë£Œë©ë‹ˆë‹¤.");

  } catch (err) {
    alert("ë§ˆì´í¬ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”!");
  }
});

async function send() {
  const input = document.getElementById("ask");
  const text = input.value.trim();
  if (!text) return;

  // âœ… ì¹´ë“œ ìˆ¨ê¸°ê¸°
  document.body.classList.add("chatting");

  const box = document.getElementById("chatBox");
  input.value = "";

  box.innerHTML += `<div class="msg user">ğŸ§‘â€ğŸ’» ${text}</div>`;
  box.scrollTop = box.scrollHeight;

  try {
    const chatRes = await fetch(`${API_BASE}/rag/chat`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ query: text })
    });
    const data = await chatRes.json();

    box.innerHTML += `<div class="msg bot">ğŸ¤– ${data.answer}</div>`;
    box.scrollTop = box.scrollHeight;

    const ttsRes = await fetch(`${API_BASE}/tts`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text: data.answer })
    });
    if (ttsRes.ok) {
      const tts = await ttsRes.json();
      new Audio(`data:audio/mpeg;base64,${tts.audio_b64}`).play();
    }

  } catch (e) {
    box.innerHTML += `<div class="msg bot">âš ï¸ ì„œë²„ ì—°ê²° ì‹¤íŒ¨: ${e.message}</div>`;
  }
}

// ìƒˆ ì±„íŒ… ë²„íŠ¼ í´ë¦­ ì‹œ ëŒ€í™”ì°½ ì´ˆê¸°í™”
  document.getElementById("newChatBtn").addEventListener("click", function (e) {
    e.preventDefault();

    const chatBox = document.querySelector(".chat-box"); // ì±„íŒ… ë‚´ìš© ì˜ì—­
    const input = document.querySelector(".chat-input input"); // ì…ë ¥ì°½

    if (chatBox) {
      chatBox.innerHTML = ""; // ëª¨ë“  ëŒ€í™” ë‚´ìš© ì‚­ì œ
    }
    if (input) {
      input.value = ""; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
    }

    // ì‚¬ìš©ì í”¼ë“œë°± ë©”ì‹œì§€ ì¶œë ¥
    const msg = document.createElement("div");
    msg.classList.add("system-message");
    msg.style.textAlign = "center";
    msg.style.color = "#6b7280";
    msg.style.margin = "20px 0";
    msg.textContent = " ìƒˆë¡œìš´ ì±„íŒ…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.";
    chatBox.appendChild(msg);
  });
</script>

</body>
</html>